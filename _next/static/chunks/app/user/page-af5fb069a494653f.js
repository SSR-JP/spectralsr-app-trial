(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{6102:function(e,t,r){Promise.resolve().then(r.bind(r,365))},365:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return S}});var n=r(9241),o=r(4299),s=r(3460),a=r(3098),c=r(8153),i=r(1527),l=r(1638),u=r(1733),d=r(2305),f=r(9806),h=r(335),p=r(511),g=r(6548),m=r(6463),v=r(5041),y=r(2265);function S(){let[e]=(0,s.fl)(),t=(0,c.PQ)(c.YI.primary.getArgb(e.scheme)),r=(0,c.PQ)(c.YI.surface.getArgb(e.scheme));(0,c.PQ)(c.YI.surfaceContainer.getArgb(e.scheme)),(0,c.PQ)(c.YI.onSurface.getArgb(e.scheme)),(0,c.PQ)(c.YI.onSurfaceVariant.getArgb(e.scheme));let S=(0,m.useRouter)(),[b,k]=(0,y.useState)("---"),[x]=(0,o.mN)(),[P,w]=(0,y.useState)(!1);(0,y.useEffect)(()=>{"connected"===x.serviceStatus&&(async()=>{let e=x.apiGatewayUrl,t=x.apiClient.getAccessToken();try{let r=await fetch("".concat(e,"/tickets/balance?token=").concat(t));if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));let n=await r.json();k(n.ticket_balance.toFixed(0))}catch(e){console.error("Failed to fetch ticket count:",e),(0,v.yv)("チケットの取得に失敗しました。",{variant:"error"})}})()},[x.serviceStatus]);let C=async()=>{w(!0);let e=x.apiGatewayUrl,t=x.apiClient.getAccessToken();try{let r=await fetch("".concat(e,"/payments/checkout-session?token=").concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));let n=await r.json();console.log("Checkout Session created:",n);let{checkout_url:o}=n;window.location.href=o}catch(e){console.error("Purchase failed:",e),(0,v.yv)("購入に失敗しました。もう一度お試しください。",{variant:"error"})}await new Promise(e=>setTimeout(e,2e3)),w(!1)};return(0,n.BX)("div",{css:(0,a.iv)({}),children:[(0,n.tZ)(u.Z,{position:"fixed",elevation:0,css:(0,a.iv)({backgroundColor:(0,d.Fq)(r,.5),backdropFilter:"blur(16px)",color:t}),children:(0,n.BX)(f.Z,{children:[(0,n.tZ)(h.Z,{size:"large",edge:"start",color:"inherit",onClick:()=>{S.back()},children:(0,n.tZ)(i.Z,{})}),(0,n.tZ)(p.Z,{variant:"h6",css:(0,a.iv)({fontWeight:"bold"}),children:"ユーザ情報"})]})}),(0,n.BX)("div",{css:(0,a.iv)({display:"flex",flexDirection:"column",marginTop:"80px",paddingLeft:"16px",paddingRight:"16px",marginLeft:"auto",marginRight:"auto",maxWidth:"1040px"}),children:[(0,n.tZ)(p.Z,{variant:"h6",css:(0,a.iv)({fontWeight:"bold"}),children:"チケット"}),(0,n.BX)("div",{css:(0,a.iv)({display:"flex",flexDirection:"column",alignSelf:"center",width:"100%",maxWidth:"288px"}),children:[(0,n.BX)("div",{css:(0,a.iv)({alignItems:"center",alignSelf:"center",padding:"8px",display:"flex",flexDirection:"row"}),children:[(0,n.tZ)(l.Z,{}),(0,n.tZ)("span",{css:(0,a.iv)({}),children:"残り"}),(0,n.BX)("span",{css:(0,a.iv)({paddingLeft:"8px",fontSize:"24px"}),children:[b,"枚"]})]}),(0,n.tZ)(g.Z,{css:(0,a.iv)({}),variant:"contained",onClick:C,disabled:P,children:P?"処理中...":"購入"})]})]})]})}},4299:function(e,t,r){"use strict";r.d(t,{Er:function(){return m},NZ:function(){return u},ZP:function(){return s},mN:function(){return p},xh:function(){return a}});var n=r(9241),o=r(2265);let s="ap-northeast-3_K70QvMlqR",a="66f3b23k8hv9ne8poim1b2d8p",c="https://n2cs0lys69.execute-api.ap-northeast-3.amazonaws.com/prod",i="".concat(c,"/services/current"),l={"ssr.broken-database":"データベースが破損しています。","ssr.incompatible-extension":"データに互換性のない拡張子が含まれています。","ssr.extension-unmatched":"拡張子が一致しません。","ssr.load-failure":"データの読み込みに失敗しました。","ssr.incompatible-npl":"データのNPLスタイルが互換性がありません。","ssr.file-info-unmatched":"ファイル間でNPL情報が統一されていません。","ssr.data-info-unmatched":"データ間でNPL情報が統一されていません。","ssr.data-size-unmatched":"データ間でサイズが統一されていません。","ssr.incorrect-parameters":"パラメータの指定が正しくありません。","ssr.get-mean-failure":"平均値の取得に失敗しました。","ssr.fitting-failure":"フィッティングに失敗しました。","ssr.wrong-fitting-result":"フィッティング結果が妥当ではありません。","ssr.out-of-memory":"メモリ不足です。","ssr.grid-contains-outside":"予想される位置が範囲外に含まれています。","ssr.others":"不明なエラーが発生しました。"};async function u(e){if(e.ok)return;if(404===e.status)return"通信先が見つかりませんでした(404)。";let t=await e.text();try{let e=JSON.parse(t);console.log(e);let r=function(e){if(void 0==e)return;let t=e.detail;if(void 0==t)return;let r=t.code,n=t.message;if(void 0!=r&&void 0!=n&&"string"==typeof r&&"string"==typeof n)return l[r]||n}(e);if(void 0!=r)return r}catch(e){console.warn("Failed to parse error response",e)}return"エラーが発生しました。".concat(e.status,": ").concat(t)}let d=(0,o.createContext)({apiClient:g(c,i,null),apiGatewayUrl:c,serviceStatus:"configuring"}),f=(0,o.createContext)(()=>{}),h=(e,t)=>"setServiceStatus"===t.type?{...e,serviceStatus:t.payload.status}:e,p=()=>{let e=(0,o.useContext)(d),t=(0,o.useContext)(f);return(0,o.useRef)(e).current=e,[e,(0,o.useMemo)(()=>({setServiceStatus:e=>{t({type:"setServiceStatus",payload:{status:e}})}}),[])]};function g(e,t,r){let n=async(e,n,o)=>{r&&n.push("token=".concat(r));let s=n.length>0?"?"+n.join("&"):"";return fetch("".concat(t,"/").concat(e).concat(s),o)};return console.log("makeApiClient()"),{serviceFetch:async(e,t,r)=>n(e,t,r),setNewAccessToken:e=>{r=e,localStorage.setItem("token",e)},getAccessToken:()=>r,restoreServiceSession:async()=>{r=localStorage.getItem("token");try{let e=await n("hello",[]);if(!e.ok)throw Error("HTTP error! status: ".concat(e.status))}catch(e){return console.error(e),!1}return!0}}}function m(e){let{children:t}=e,r=(0,o.useMemo)(()=>g(c,i,null),[]),[s,a]=(0,o.useReducer)(h,{apiClient:r,apiGatewayUrl:c,serviceStatus:"configuring"}),l=(0,o.useRef)(!1);return(0,o.useEffect)(()=>{if(!l.current)return async function(){try{let e=await s.apiClient.restoreServiceSession();console.log("restoreServiceSession",e),e?a({type:"setServiceStatus",payload:{status:"connected"}}):a({type:"setServiceStatus",payload:{status:"not-login"}})}catch(e){console.error(e),a({type:"setServiceStatus",payload:{status:"not-login"}})}}(),()=>{l.current=!0}},[]),(0,n.tZ)(d.Provider,{value:s,children:(0,n.tZ)(f.Provider,{value:a,children:t})})}},3460:function(e,t,r){"use strict";r.d(t,{ThemeStoreProvider:function(){return m},fl:function(){return p}});var n=r(9241),o=r(8438),s=r.n(o),a=r(9380),c=r(2686),i=r(1705),l=r(8153),u=r(2265),d=r(1246);let f=(0,u.createContext)({scheme:new l.S2(l.OP.fromInt(4435848),!1,-1),sourceColor:4435848}),h=(0,u.createContext)(()=>{}),p=()=>{let e=(0,u.useContext)(f),t=(0,u.useContext)(h);return[e,{resetSourceColor:()=>{t({type:"setTheme",payload:{scheme:new l.S2(l.OP.fromInt(4435848),!1,-1),sourceColor:4435848}})}}]},g=(e,t)=>{if("setTheme"===t.type){let{scheme:r,sourceColor:n}=t.payload;return e.sourceColor===n?e:{...e,scheme:r,sourceColor:n}}return e},m=e=>{let{children:t}=e,[r,o]=(0,u.useReducer)(g,{scheme:new l.S2(l.OP.fromInt(4435848),!1,-1),sourceColor:4435848}),p=(0,a.Z)((0,c.Z)({palette:{mode:"light",primary:{main:(0,l.PQ)(l.YI.primary.getArgb(r.scheme))},secondary:{main:(0,l.PQ)(l.YI.secondary.getArgb(r.scheme))},background:{default:(0,l.PQ)(l.YI.surface.getArgb(r.scheme)),paper:(0,l.PQ)(l.YI.surfaceContainer.getArgb(r.scheme))},error:{main:(0,l.PQ)(l.YI.error.getArgb(r.scheme))},text:{primary:(0,l.PQ)(l.YI.onSurface.getArgb(r.scheme))}},typography:{fontFamily:s().style.fontFamily}}));return(0,n.BX)(i.Z,{theme:p,children:[(0,n.tZ)(d.Z,{styles:e=>({body:{transition:e.transitions.create(["background-color","transform"])}})}),(0,n.tZ)(f.Provider,{value:r,children:(0,n.tZ)(h.Provider,{value:o,children:t})})]})}}},function(e){e.O(0,[665,388,526,41,36,650,237,971,23,744],function(){return e(e.s=6102)}),_N_E=e.O()}]);