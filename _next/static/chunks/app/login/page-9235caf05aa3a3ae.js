(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{6249:function(){},7025:function(e,r,t){Promise.resolve().then(t.bind(t,5207))},5207:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return C}});var n=t(9241),o=t(4299),i=t(511),s=t(8549),a=t(7351),c=t(1236),u=t(6548),l=t(1096),d=t(824),f=t(385),v=t(6631),h=t(2265),m=t(3098),p=t(5041),y=t(6463),g=t(3460),Z=t(8153);async function S(e){e.resendConfirmationCode(function(e,r){if(e){console.error(e),(0,p.yv)("確認コードの再送に失敗しました: ".concat(e),{variant:"error"});return}(0,p.yv)("確認コードを再送しました")})}function C(){let[e]=(0,o.mN)(),[r]=(0,g.fl)(),t=(0,Z.PQ)(Z.YI.primary.getArgb(r.scheme));(0,Z.PQ)(Z.YI.onSurface.getArgb(r.scheme)),(0,Z.PQ)(Z.YI.onSurfaceVariant.getArgb(r.scheme));let[C,w]=(0,h.useState)("login"),P=(0,y.useRouter)(),x=(0,h.useRef)(null),b=(0,h.useRef)(null),k=(0,h.useRef)(null),I=(0,h.useRef)(void 0),A=(0,h.useRef)(),R=(0,h.useMemo)(()=>new v.AM({UserPoolId:o.ZP,ClientId:o.xh}),[]);return(0,n.tZ)("div",{children:(0,n.BX)("div",{css:(0,m.iv)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh"}),children:[(0,n.tZ)(i.Z,{variant:"h4",css:(0,m.iv)({color:t,fontWeight:"bold"}),children:"ログイン"}),(0,n.BX)("div",{css:(0,m.iv)({marginTop:16,display:"flex",flexDirection:"column"}),children:[(0,n.BX)(s.Z,{variant:"standard",css:(0,m.iv)({}),children:[(0,n.tZ)(a.Z,{children:"メールアドレス"}),(0,n.tZ)(c.Z,{type:"email",inputRef:x})]}),(0,n.BX)(s.Z,{variant:"standard",css:(0,m.iv)({marginTop:8}),children:[(0,n.tZ)(a.Z,{children:"パスワード"}),(0,n.tZ)(c.Z,{type:"password",inputRef:b})]}),(0,n.BX)("div",{css:(0,m.iv)({marginTop:32,display:"flex",flexDirection:"row",justifyContent:"flex-end"}),children:[(0,n.tZ)(u.Z,{onClick:()=>{P.push("/signup")},children:"アカウントを新規作成する"}),(0,n.tZ)(u.Z,{variant:"contained",onClick:()=>{var r,t;let n=null===(r=x.current)||void 0===r?void 0:r.value,o=null===(t=b.current)||void 0===t?void 0:t.value;if(!n||!o){(0,p.yv)("メールアドレスとパスワードを入力してください。",{variant:"error"});return}let i=new v.sD({Username:n,Password:o}),s=new v.ws({Username:n,Pool:R});I.current=s,A.current={email:n,password:o},s.authenticateUser(i,{onSuccess:function(r){let t=r.getAccessToken().getJwtToken();(0,p.yv)("ログイン成功"),e.apiClient.setNewAccessToken(t),P.push("/launch-service")},onFailure:function(e){switch(console.error(e),e.name){case"NotAuthorizedException":(0,p.yv)("メールアドレスもしくはパスワードが異なります",{variant:"error"});break;case"UserNotConfirmedException":S(s),w("confirm");break;default:(0,p.yv)("ログイン失敗: ".concat(e),{variant:"error"})}}})},children:"ログイン"})]})]}),(0,n.BX)(l.Z,{open:"confirm"===C,sx:{"& .MuiDialog-paper":{borderRadius:3}},children:[(0,n.tZ)(d.Z,{children:"確認コードを入力"}),(0,n.BX)(f.Z,{css:(0,m.iv)({display:"flex",flexDirection:"column"}),children:[(0,n.BX)(s.Z,{variant:"standard",css:(0,m.iv)({}),children:[(0,n.tZ)(a.Z,{children:"確認コード"}),(0,n.tZ)(c.Z,{inputRef:k})]}),(0,n.tZ)(u.Z,{variant:"contained",css:(0,m.iv)({marginTop:16}),onClick:()=>{var e;let r=null===(e=k.current)||void 0===e?void 0:e.value;if(!r){(0,p.yv)("confirmation code is required",{variant:"error"});return}let t=I.current;if(!t){(0,p.yv)("user is not found",{variant:"error"});return}t.confirmRegistration(r,!0,(e,r)=>{if(e){(0,p.yv)(e.message,{variant:"error"});return}(0,p.yv)("コード確認: ".concat(r));let n=A.current;if(!n){(0,p.yv)("user auth info is not found",{variant:"error"});return}t.authenticateUser(new v.sD({Username:n.email,Password:n.password}),{onSuccess:function(e){e.getIdToken().getJwtToken(),(0,p.yv)("ログイン成功"),P.push("/launch-service")},onFailure:function(e){(0,p.yv)("login failed",{variant:"error"}),console.error(e)}})})},children:"確認"})]})]})]})})}},4299:function(e,r,t){"use strict";t.d(r,{Er:function(){return p},NZ:function(){return l},ZP:function(){return i},mN:function(){return h},xh:function(){return s}});var n=t(9241),o=t(2265);let i="ap-northeast-3_K70QvMlqR",s="66f3b23k8hv9ne8poim1b2d8p",a="https://n2cs0lys69.execute-api.ap-northeast-3.amazonaws.com/prod",c="".concat(a,"/services/current"),u={"ssr.broken-database":"データベースが破損しています。","ssr.incompatible-extension":"データに互換性のない拡張子が含まれています。","ssr.extension-unmatched":"拡張子が一致しません。","ssr.load-failure":"データの読み込みに失敗しました。","ssr.incompatible-npl":"データのNPLスタイルが互換性がありません。","ssr.file-info-unmatched":"ファイル間でNPL情報が統一されていません。","ssr.data-info-unmatched":"データ間でNPL情報が統一されていません。","ssr.data-size-unmatched":"データ間でサイズが統一されていません。","ssr.incorrect-parameters":"パラメータの指定が正しくありません。","ssr.get-mean-failure":"平均値の取得に失敗しました。","ssr.fitting-failure":"フィッティングに失敗しました。","ssr.wrong-fitting-result":"フィッティング結果が妥当ではありません。","ssr.out-of-memory":"メモリ不足です。","ssr.grid-contains-outside":"予想される位置が範囲外に含まれています。","ssr.others":"不明なエラーが発生しました。"};async function l(e){if(e.ok)return;if(404===e.status)return"通信先が見つかりませんでした(404)。";let r=await e.text();try{let e=JSON.parse(r);console.log(e);let t=function(e){if(void 0==e)return;let r=e.detail;if(void 0==r)return;let t=r.code,n=r.message;if(void 0!=t&&void 0!=n&&"string"==typeof t&&"string"==typeof n)return u[t]||n}(e);if(void 0!=t)return t}catch(e){console.warn("Failed to parse error response",e)}return"エラーが発生しました。".concat(e.status,": ").concat(r)}let d=(0,o.createContext)({apiClient:m(a,c,null),apiGatewayUrl:a,serviceStatus:"configuring"}),f=(0,o.createContext)(()=>{}),v=(e,r)=>"setServiceStatus"===r.type?{...e,serviceStatus:r.payload.status}:e,h=()=>{let e=(0,o.useContext)(d),r=(0,o.useContext)(f);return(0,o.useRef)(e).current=e,[e,(0,o.useMemo)(()=>({setServiceStatus:e=>{r({type:"setServiceStatus",payload:{status:e}})}}),[])]};function m(e,r,t){let n=async(e,n,o)=>{let i=n.length>0?"?"+n.join("&"):"",s="".concat(r,"/").concat(e).concat(i),a=new Headers(null==o?void 0:o.headers);return t&&a.set("Authorization","Bearer ".concat(t)),fetch(s,{...o,headers:a})};return console.log("makeApiClient()"),{serviceFetch:async(e,r,t)=>n(e,r,t),setNewAccessToken:e=>{t=e,localStorage.setItem("token",e)},getAccessToken:()=>t,restoreServiceSession:async()=>{t=localStorage.getItem("token");try{let e=await n("hello",[]);if(!e.ok)throw Error("HTTP error! status: ".concat(e.status))}catch(e){return console.error(e),!1}return!0}}}function p(e){let{children:r}=e,t=(0,o.useMemo)(()=>m(a,c,null),[]),[i,s]=(0,o.useReducer)(v,{apiClient:t,apiGatewayUrl:a,serviceStatus:"configuring"}),u=(0,o.useRef)(!1);return(0,o.useEffect)(()=>{if(!u.current)return async function(){try{let e=await i.apiClient.restoreServiceSession();console.log("restoreServiceSession",e),e?s({type:"setServiceStatus",payload:{status:"connected"}}):s({type:"setServiceStatus",payload:{status:"not-login"}})}catch(e){console.error(e),s({type:"setServiceStatus",payload:{status:"not-login"}})}}(),()=>{u.current=!0}},[]),(0,n.tZ)(d.Provider,{value:i,children:(0,n.tZ)(f.Provider,{value:s,children:r})})}},3460:function(e,r,t){"use strict";t.d(r,{ThemeStoreProvider:function(){return p},fl:function(){return h}});var n=t(9241),o=t(8438),i=t.n(o),s=t(9380),a=t(2686),c=t(1705),u=t(8153),l=t(2265),d=t(1246);let f=(0,l.createContext)({scheme:new u.S2(u.OP.fromInt(4435848),!1,-1),sourceColor:4435848}),v=(0,l.createContext)(()=>{}),h=()=>{let e=(0,l.useContext)(f),r=(0,l.useContext)(v);return[e,{resetSourceColor:()=>{r({type:"setTheme",payload:{scheme:new u.S2(u.OP.fromInt(4435848),!1,-1),sourceColor:4435848}})}}]},m=(e,r)=>{if("setTheme"===r.type){let{scheme:t,sourceColor:n}=r.payload;return e.sourceColor===n?e:{...e,scheme:t,sourceColor:n}}return e},p=e=>{let{children:r}=e,[t,o]=(0,l.useReducer)(m,{scheme:new u.S2(u.OP.fromInt(4435848),!1,-1),sourceColor:4435848}),h=(0,s.Z)((0,a.Z)({palette:{mode:"light",primary:{main:(0,u.PQ)(u.YI.primary.getArgb(t.scheme))},secondary:{main:(0,u.PQ)(u.YI.secondary.getArgb(t.scheme))},background:{default:(0,u.PQ)(u.YI.surface.getArgb(t.scheme)),paper:(0,u.PQ)(u.YI.surfaceContainer.getArgb(t.scheme))},error:{main:(0,u.PQ)(u.YI.error.getArgb(t.scheme))},text:{primary:(0,u.PQ)(u.YI.onSurface.getArgb(t.scheme))}},typography:{fontFamily:i().style.fontFamily}}));return(0,n.BX)(c.Z,{theme:h,children:[(0,n.tZ)(d.Z,{styles:e=>({body:{transition:e.transitions.create(["background-color","transform"])}})}),(0,n.tZ)(f.Provider,{value:t,children:(0,n.tZ)(v.Provider,{value:o,children:r})})]})}}},function(e){e.O(0,[665,388,526,41,36,650,2,380,273,109,631,971,23,744],function(){return e(e.s=7025)}),_N_E=e.O()}]);