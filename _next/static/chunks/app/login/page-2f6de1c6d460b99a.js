(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{6249:function(){},7025:function(e,t,r){Promise.resolve().then(r.bind(r,5207))},5207:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return C}});var n=r(9241),o=r(4299),i=r(511),s=r(8549),a=r(7351),c=r(1236),u=r(6548),l=r(1096),d=r(824),f=r(385),v=r(6631),h=r(2265),m=r(3098),p=r(5041),y=r(6463),g=r(3460),Z=r(8153);async function S(e){e.resendConfirmationCode(function(e,t){if(e){console.error(e),(0,p.yv)("確認コードの再送に失敗しました: ".concat(e),{variant:"error"});return}(0,p.yv)("確認コードを再送しました")})}function C(){let[e]=(0,o.mN)(),[t]=(0,g.fl)(),r=(0,Z.PQ)(Z.YI.primary.getArgb(t.scheme));(0,Z.PQ)(Z.YI.onSurface.getArgb(t.scheme)),(0,Z.PQ)(Z.YI.onSurfaceVariant.getArgb(t.scheme));let[C,w]=(0,h.useState)("login"),P=(0,y.useRouter)(),x=(0,h.useRef)(null),k=(0,h.useRef)(null),b=(0,h.useRef)(null),I=(0,h.useRef)(void 0),A=(0,h.useRef)(),R=(0,h.useMemo)(()=>new v.AM({UserPoolId:o.ZP,ClientId:o.xh}),[]);return(0,n.tZ)("div",{children:(0,n.BX)("div",{css:(0,m.iv)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh"}),children:[(0,n.tZ)(i.Z,{variant:"h4",css:(0,m.iv)({color:r,fontWeight:"bold"}),children:"ログイン"}),(0,n.BX)("div",{css:(0,m.iv)({marginTop:16,display:"flex",flexDirection:"column"}),children:[(0,n.BX)(s.Z,{variant:"standard",css:(0,m.iv)({}),children:[(0,n.tZ)(a.Z,{children:"メールアドレス"}),(0,n.tZ)(c.Z,{type:"email",inputRef:x})]}),(0,n.BX)(s.Z,{variant:"standard",css:(0,m.iv)({marginTop:8}),children:[(0,n.tZ)(a.Z,{children:"パスワード"}),(0,n.tZ)(c.Z,{type:"password",inputRef:k})]}),(0,n.BX)("div",{css:(0,m.iv)({marginTop:32,display:"flex",flexDirection:"row",justifyContent:"flex-end"}),children:[(0,n.tZ)(u.Z,{onClick:()=>{P.push("/signup")},children:"アカウントを新規作成する"}),(0,n.tZ)(u.Z,{variant:"contained",onClick:()=>{var t,r;let n=null===(t=x.current)||void 0===t?void 0:t.value,o=null===(r=k.current)||void 0===r?void 0:r.value;if(!n||!o){(0,p.yv)("メールアドレスとパスワードを入力してください。",{variant:"error"});return}let i=new v.sD({Username:n,Password:o}),s=new v.ws({Username:n,Pool:R});I.current=s,A.current={email:n,password:o},s.authenticateUser(i,{onSuccess:function(t){let r=t.getAccessToken().getJwtToken();(0,p.yv)("ログイン成功"),e.apiClient.setNewAccessToken(r),P.push("/launch-service")},onFailure:function(e){switch(console.error(e),e.name){case"NotAuthorizedException":(0,p.yv)("メールアドレスもしくはパスワードが異なります",{variant:"error"});break;case"UserNotConfirmedException":S(s),w("confirm");break;default:(0,p.yv)("ログイン失敗: ".concat(e),{variant:"error"})}}})},children:"ログイン"})]})]}),(0,n.BX)(l.Z,{open:"confirm"===C,sx:{"& .MuiDialog-paper":{borderRadius:3}},children:[(0,n.tZ)(d.Z,{children:"確認コードを入力"}),(0,n.BX)(f.Z,{css:(0,m.iv)({display:"flex",flexDirection:"column"}),children:[(0,n.BX)(s.Z,{variant:"standard",css:(0,m.iv)({}),children:[(0,n.tZ)(a.Z,{children:"確認コード"}),(0,n.tZ)(c.Z,{inputRef:b})]}),(0,n.tZ)(u.Z,{variant:"contained",css:(0,m.iv)({marginTop:16}),onClick:()=>{var e;let t=null===(e=b.current)||void 0===e?void 0:e.value;if(!t){(0,p.yv)("confirmation code is required",{variant:"error"});return}let r=I.current;if(!r){(0,p.yv)("user is not found",{variant:"error"});return}r.confirmRegistration(t,!0,(e,t)=>{if(e){(0,p.yv)(e.message,{variant:"error"});return}(0,p.yv)("コード確認: ".concat(t));let n=A.current;if(!n){(0,p.yv)("user auth info is not found",{variant:"error"});return}r.authenticateUser(new v.sD({Username:n.email,Password:n.password}),{onSuccess:function(e){e.getIdToken().getJwtToken(),(0,p.yv)("ログイン成功"),P.push("/launch-service")},onFailure:function(e){(0,p.yv)("login failed",{variant:"error"}),console.error(e)}})})},children:"確認"})]})]})]})})}},4299:function(e,t,r){"use strict";r.d(t,{Er:function(){return p},NZ:function(){return l},ZP:function(){return i},mN:function(){return h},xh:function(){return s}});var n=r(9241),o=r(2265);let i="ap-northeast-3_K70QvMlqR",s="66f3b23k8hv9ne8poim1b2d8p",a="https://n2cs0lys69.execute-api.ap-northeast-3.amazonaws.com/prod",c="".concat(a,"/services/current"),u={"ssr.broken-database":"データベースが破損しています。","ssr.incompatible-extension":"データに互換性のない拡張子が含まれています。","ssr.extension-unmatched":"拡張子が一致しません。","ssr.load-failure":"データの読み込みに失敗しました。","ssr.incompatible-npl":"データのNPLスタイルが互換性がありません。","ssr.file-info-unmatched":"ファイル間でNPL情報が統一されていません。","ssr.data-info-unmatched":"データ間でNPL情報が統一されていません。","ssr.data-size-unmatched":"データ間でサイズが統一されていません。","ssr.incorrect-parameters":"パラメータの指定が正しくありません。","ssr.get-mean-failure":"平均値の取得に失敗しました。","ssr.fitting-failure":"フィッティングに失敗しました。","ssr.wrong-fitting-result":"フィッティング結果が妥当ではありません。","ssr.out-of-memory":"メモリ不足です。","ssr.grid-contains-outside":"予想される位置が範囲外に含まれています。","ssr.others":"不明なエラーが発生しました。"};async function l(e){if(e.ok)return;if(404===e.status)return"通信先が見つかりませんでした(404)。";let t=await e.text();try{let e=JSON.parse(t);console.log(e);let r=function(e){if(void 0==e)return;let t=e.detail;if(void 0==t)return;let r=t.code,n=t.message;if(void 0!=r&&void 0!=n&&"string"==typeof r&&"string"==typeof n)return u[r]||n}(e);if(void 0!=r)return r}catch(e){console.warn("Failed to parse error response",e)}return"エラーが発生しました。".concat(e.status,": ").concat(t)}let d=(0,o.createContext)({apiClient:m(a,c,null),apiGatewayUrl:a,serviceStatus:"configuring"}),f=(0,o.createContext)(()=>{}),v=(e,t)=>"setServiceStatus"===t.type?{...e,serviceStatus:t.payload.status}:e,h=()=>{let e=(0,o.useContext)(d),t=(0,o.useContext)(f);return(0,o.useRef)(e).current=e,[e,(0,o.useMemo)(()=>({setServiceStatus:e=>{t({type:"setServiceStatus",payload:{status:e}})}}),[])]};function m(e,t,r){let n=async(e,n,o)=>{r&&n.push("token=".concat(r));let i=n.length>0?"?"+n.join("&"):"";return fetch("".concat(t,"/").concat(e).concat(i),o)};return console.log("makeApiClient()"),{serviceFetch:async(e,t,r)=>n(e,t,r),setNewAccessToken:e=>{r=e,localStorage.setItem("token",e)},getAccessToken:()=>r,restoreServiceSession:async()=>{r=localStorage.getItem("token");try{let e=await n("hello",[]);if(!e.ok)throw Error("HTTP error! status: ".concat(e.status))}catch(e){return console.error(e),!1}return!0}}}function p(e){let{children:t}=e,r=(0,o.useMemo)(()=>m(a,c,null),[]),[i,s]=(0,o.useReducer)(v,{apiClient:r,apiGatewayUrl:a,serviceStatus:"configuring"}),u=(0,o.useRef)(!1);return(0,o.useEffect)(()=>{if(!u.current)return async function(){try{let e=await i.apiClient.restoreServiceSession();console.log("restoreServiceSession",e),e?s({type:"setServiceStatus",payload:{status:"connected"}}):s({type:"setServiceStatus",payload:{status:"not-login"}})}catch(e){console.error(e),s({type:"setServiceStatus",payload:{status:"not-login"}})}}(),()=>{u.current=!0}},[]),(0,n.tZ)(d.Provider,{value:i,children:(0,n.tZ)(f.Provider,{value:s,children:t})})}},3460:function(e,t,r){"use strict";r.d(t,{ThemeStoreProvider:function(){return p},fl:function(){return h}});var n=r(9241),o=r(8438),i=r.n(o),s=r(9380),a=r(2686),c=r(1705),u=r(8153),l=r(2265),d=r(1246);let f=(0,l.createContext)({scheme:new u.S2(u.OP.fromInt(4435848),!1,-1),sourceColor:4435848}),v=(0,l.createContext)(()=>{}),h=()=>{let e=(0,l.useContext)(f),t=(0,l.useContext)(v);return[e,{resetSourceColor:()=>{t({type:"setTheme",payload:{scheme:new u.S2(u.OP.fromInt(4435848),!1,-1),sourceColor:4435848}})}}]},m=(e,t)=>{if("setTheme"===t.type){let{scheme:r,sourceColor:n}=t.payload;return e.sourceColor===n?e:{...e,scheme:r,sourceColor:n}}return e},p=e=>{let{children:t}=e,[r,o]=(0,l.useReducer)(m,{scheme:new u.S2(u.OP.fromInt(4435848),!1,-1),sourceColor:4435848}),h=(0,s.Z)((0,a.Z)({palette:{mode:"light",primary:{main:(0,u.PQ)(u.YI.primary.getArgb(r.scheme))},secondary:{main:(0,u.PQ)(u.YI.secondary.getArgb(r.scheme))},background:{default:(0,u.PQ)(u.YI.surface.getArgb(r.scheme)),paper:(0,u.PQ)(u.YI.surfaceContainer.getArgb(r.scheme))},error:{main:(0,u.PQ)(u.YI.error.getArgb(r.scheme))},text:{primary:(0,u.PQ)(u.YI.onSurface.getArgb(r.scheme))}},typography:{fontFamily:i().style.fontFamily}}));return(0,n.BX)(c.Z,{theme:h,children:[(0,n.tZ)(d.Z,{styles:e=>({body:{transition:e.transitions.create(["background-color","transform"])}})}),(0,n.tZ)(f.Provider,{value:r,children:(0,n.tZ)(v.Provider,{value:o,children:t})})]})}}},function(e){e.O(0,[665,388,526,41,36,650,2,380,273,109,631,971,23,744],function(){return e(e.s=7025)}),_N_E=e.O()}]);